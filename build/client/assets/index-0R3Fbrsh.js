import{r as n,j as e,L as le,b as ce}from"./components-B3s0IpTW.js";import{R as re,F as ne}from"./Footer-CYY9kVHS.js";import{L as oe,S as de}from"./LatestStarRating-BDPz__Nt.js";import{e as ie,f as xe,i as me,j as he,k as M,l as ue,m as pe}from"./Lib-DgMjv0aD.js";import{d as je,B as W,a as I}from"./index-mlrjDXrT.js";import{u as $,I as fe}from"./SliderContext-DisLTAdC.js";import{o as ge,p as ve,q as Ne}from"./index-CB7nKGqz.js";import{u as z}from"./AuthContext-8FHLzqeM.js";import{u as T}from"./NotificationContext-7wGW9xfz.js";import{u as be,s as we,z as y}from"./index-DAH1x-Px.js";import{B as C}from"./index-BLFHDWCD.js";import"./MobileNav-BsYC7GnI.js";import"./iconBase-Bk1nv4PK.js";import"./index-CIOWmsy1.js";import"./index-CDpADjvc.js";import"./SearchBox-Dvw5_xIS.js";const ye=({title:s,subtitle:t,category:a,limit:l})=>{const[i,r]=n.useState(""),[d,m]=n.useState(""),[u,p]=n.useState([]);n.useEffect(()=>{s&&t&&(r(s),m(t))},[s,t]);let g=async(o,x)=>{if(x&&o){let j=await ie(o,x);p(j)}};return n.useEffect(()=>{l&&a&&g(a,l)},[l,a]),e.jsx("div",{className:"w-[95%] md:w-[90%] xl:w-[80%] mx-auto",children:e.jsxs("div",{className:"mt-10 border-t pt-5",children:[e.jsxs("div",{className:" mb-[20px] ",children:[e.jsx("div",{className:"font-semibold text-xl",children:i}),e.jsx("div",{className:"text-sm -mt-[2px]",children:d})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-3 gap-y-4",children:u==null?void 0:u.map((o,x)=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(le,{to:`/${o.gid}`,children:e.jsx("div",{className:"relative h-[180px]",children:e.jsx("img",{className:`object-cover w-full h-full
                                                    text-sm`,src:o==null?void 0:o.image_url,alt:o.title})})})}),e.jsx("div",{className:`mt-1 text-[15px] tracking-tight 
                                     truncate`,children:o.title}),e.jsx("div",{className:"mt-1",children:e.jsx(oe,{rating:o.avg_rating})}),e.jsx("div",{className:`text-[11px] mt-[5px] tracking-tight
                                    leading-[1.2em]`,children:o.short_description.substring(0,100)})]},x))})]})})},Se=({listing:s})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-[24px] font-bold mt-[0px] leading-7",children:s==null?void 0:s.title}),e.jsxs("div",{className:"text-[13px] mt-1.5 leading-[1.2em]",children:[s!=null&&s.address_one?`${s==null?void 0:s.address_one}, `:"",s!=null&&s.address_two?`${s==null?void 0:s.address_two}, `:"",s!=null&&s.city_name?`${s==null?void 0:s.city_name}, `:"",s!=null&&s.state_name?`${s==null?void 0:s.state_name}, `:"",s==null?void 0:s.country_name]})]}),U=n.createContext(null);function Re(){const s=n.useContext(U);if(!s)throw new Error("useGallery must be used within a GalleryProvider");return s}const _e=({children:s})=>{const[t,a]=n.useState(!1),[l,i]=n.useState(null),r=$(),[d,m]=n.useState(null),u="https://oxbyt.com",p=()=>a(!1);let g={setShow:a,setGallery:i,setListing:m};const o=x=>{r.setDialog(!0),r.setSelectedSlide(x+1),r.setGallery(l)};return e.jsxs(U.Provider,{value:g,children:[t&&e.jsx("div",{onMouseDown:x=>a(!1),className:`flex w-screen h-screen bg-black/40 
                        z-[3000] fixed top-0 left-0 right-0 bottom-0
                        place-items-center place-content-center px-[15px]`,children:e.jsxs("div",{onMouseDown:x=>x.stopPropagation(),className:`w-[95%] sm:w-[95%] md:w-[80%] h-fit mx-auto
                         bg-white rounded-lg shadow-md space-y-6
                         z-[3100] overflow-hidden`,children:[e.jsxs("div",{className:"w-full h-full",children:[e.jsx("div",{className:"border-b py-3 px-3",children:e.jsxs("div",{className:`font-bold text-gray-700
                                    text-xl`,children:["Gallery for ",d&&(d==null?void 0:d.title)]})}),e.jsx("div",{className:`grid grid-cols-4 md:grid-cols-6 gap-2 
                                max-h-[300px] overflow-y-auto pt-2 px-2 pb-2
                                bg-black`,children:l&&(l==null?void 0:l.map((x,j)=>e.jsx("div",{onClick:()=>o(j),className:`relative hover:cursor-pointer
                                                 bg-red-200 md:h-[100px] lg:h-[120px] rounded-md
                                                 overflow-hidden`,children:e.jsx("img",{className:"object-cover w-full h-full",src:u+x.image_url,alt:""})})))})]}),e.jsx("div",{onMouseDown:()=>p(),className:`w-[50px] h-[50px] z-[300] bg-white
                                flex place-content-center place-items-center
                                rounded-full absolute left-2 top-2 cursor-pointer
                                hover:bg-white/40 transition duration-1000 ease-in-out`,children:e.jsx(fe,{className:"text-[30px]"})})]})}),s]})},ke=({images:s,listing:t})=>{const a="https://oxbyt.com",[l,i]=n.useState([]),r=$(),d=Re(),[m,u]=n.useState([]);n.useEffect(()=>{let o=[...l];s&&(s.map((x,j)=>{j+1<12&&o.push(x)}),u(o))},[s]);const p=o=>{r.setDialog(!0),r.setSelectedSlide(o+1),r.setGallery(s),r.setListing(t)},g=o=>{d.setShow(!0),d.setGallery(s),d.setListing(t)};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2 ",children:[m.length>1&&m.map((o,x)=>e.jsx("div",{children:e.jsx("div",{className:`h-[100px] sm:h-[100px] lg:h-[100px]
                                    hover:cursor-pointer`,onMouseDown:j=>p(x),children:e.jsx("img",{src:a+o.image_url,alt:o.alt,className:`object-cover w-full h-full rounded-md shadow-md 
                                                transition-transform`})},x)},x)),m.length>1&&e.jsx("div",{onMouseDown:o=>g(),className:" h-[100px] sm:h-[100px] lg:h-[100px] relative",children:e.jsxs("div",{className:`w-full h-full rounded-md shadow-md 
                                            transition-transform bg-black/80 flex flex-col
                                            place-items-center place-content-center text-white
                                            text-[20px] cursor-pointer`,children:[e.jsx(je,{})," view all..."]})})]}),m.length>1&&e.jsx("div",{className:"h-2"})]})},Ce=({listing:s})=>{const[t,a]=n.useState("");return n.useEffect(()=>{s.gid&&xe(s.gid).then(i=>{a(i.image_url)})},[s]),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"font-bold text-lg",children:"About this business"}),e.jsxs("div",{className:`flex place-items-start place-content-start
                gap-2 mt-4 mb-3`,children:[e.jsx("div",{className:`rounded-full bg-black w-[30px] h-[30px]
                    overflow-hidden relative`,children:e.jsx("img",{className:"object-cover w-full h-full",src:t,alt:""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-md font-bold tracking-tight leading-[1.2em]",children:s.title}),e.jsx("div",{className:"text-[12px] capitalize",children:s.category})]})]}),e.jsx("div",{className:"flex flex-col gap-y-5 text-[14px] mt-4 whitespace-pre-wrap",children:s==null?void 0:s.long_description})]})},F=()=>e.jsxs("div",{className:"bg-blue-50/50 rounded-[5px] overflow-hidden  px-0 pt-0 pb-5 w-full",children:[e.jsx("div",{className:`font-bold text-[18px] border-b pb-2 
                 shadow-gray-700/40 px-3 bg-blue-100/50 pt-3`,children:"Address"}),e.jsx("div",{className:"h-[30px]"}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-3 lg:grid-cols-1 
            text-[14px] space-y-3 sm:space-y-0  lg:space-y-3 tracking-tight
            md:space-x-4 lg:space-x-0 text-black/80 font-sans
            px-3`,children:[e.jsx("div",{className:" w-full",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-1 ",children:e.jsx(ge,{className:"text-[22px]"})}),e.jsx("div",{className:"col-span-11 leading-[1.2em] ml-2",children:"13 West Bestern Street, 23897, New York City, USA"})]})}),e.jsx("div",{className:"  w-full",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(ve,{className:"text-[22px]"})}),e.jsx("div",{className:"col-span-11 leading-[1.2em] ml-2",children:"+1 54 98 345 9"})]})}),e.jsx("div",{className:"  w-full",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(Ne,{className:"text-[22px]"})}),e.jsx("div",{className:"col-span-11 leading-[1.2em] ml-2",children:"www.google.com/entry/permit"})]})})]})]}),S=100,O=n.createContext(null);function De(){const s=n.useContext(O);if(!s)throw new Error("useRating must be used within a RatingProvider");return s}const Le=y.object({fullname:y.any(),rating:y.any(),comment:y.any()});function Be({children:s}){var L,B,E;const[t,a]=n.useState(!1),[l,i]=n.useState(!1),[r,d]=n.useState(null),[m,u]=n.useState(void 0),[p,g]=n.useState(""),o=T(),[x,j]=n.useState(5);let{user:H}=z();const[Ae,K]=n.useState(null),[V,w]=n.useState(!1),D=c=>c.trim()===""?0:c.trim().split(/\s+/).length,R=c=>{let h=c.target.value,f=c.target.name;K(N=>({...N,[f]:h}))},{register:_,handleSubmit:q,getValues:We,setValue:k,watch:J,reset:Y,setError:Ie,formState:{errors:v,isSubmitting:$e}}=be({resolver:we(Le)}),Q=c=>{const h=c.target.value,f=h.trim().split(/\s+/);if(f.length<=S)k("text",h),w(!1);else{w(!0);const N=f.slice(0,S).join(" ");k("text",N)}},X=async c=>{o.notify("Working..."),await new Promise(b=>setTimeout(b,1e3));const h=H.guid,f=r.gid;c.user_guid=h,c.business_guid=f;const te="https://gursse.com"+"/api/rating";try{const b=await fetch(te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),ae=await b.json();b.ok?o.alert("Success","Rating submitted successfully!"):o.alert("Error",ae.error)}catch(b){o.alert("",b.message)}};let Z={show:t,setShow:a,setListing:d,reset:Y,setRatingData:u,validateData:async(c,h)=>{if((c==null?void 0:c.length)===0){let f=(h==null?void 0:h.first_name)||"",N=(h==null?void 0:h.last_name)||"",G=f+" "+N;k("fullname",G)}}};const ee=J("text")||"",se=c=>{ee.trim().split(/\s+/).length>=S&&c.key!=="Backspace"&&c.key!=="Delete"&&!c.ctrlKey?(c.preventDefault(),w(!0)):w(!1)};return e.jsxs(O.Provider,{value:Z,children:[t&&e.jsx("div",{className:`flex w-screen h-screen bg-black/40 z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 place-items-center place-content-center`,children:e.jsxs("div",{className:"w-[450px] h-fit mx-auto p-6 bg-white rounded-xl shadow-md space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create/Edit Rating"}),e.jsxs("form",{onSubmit:q(X),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Full Name"}),e.jsx("input",{..._("fullname",{onChange:R}),type:"text",className:"w-full px-3 py-2 border rounded-md",placeholder:"Enter Business GUID"}),((L=v.fullname)==null?void 0:L.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:v.fullname.message.toString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Stars"}),e.jsx("select",{..._("rating",{onChange:c=>{j(Number(c.target.value)),R(c)}}),className:"w-full px-3 py-2 border rounded-md",children:[5,4,3,2,1].map(c=>e.jsxs("option",{value:c,children:[c," Star",c>1?"s":""]},c))}),((B=v.rating)==null?void 0:B.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:v.rating.message.toString()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex place-content-between",children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Comment"}),e.jsxs("label",{className:" text-gray-600 text-sm",children:["Word Count: ",e.jsx("strong",{children:D(p)})]})]}),e.jsx("textarea",{..._("comment",{onChange:c=>{D(p)<=S?(g(c.target.value),Q(c),R(c)):c.preventDefault()}}),onKeyDown:se,className:"w-full px-3 py-2 border rounded-md text-sm",placeholder:"Write your review...",rows:4}),V&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:"Maximum maximumWords words allowed."}),((E=v.comment)==null?void 0:E.message)&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:v.comment.message.toString()})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>a(!1),className:`w-full bg-red-200 rounded-md
                                        hover:bg-red-100`,children:"Close"}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700",children:l?"Submitting...":"Submit Rating"})]})]})]})}),s]})}const P=({listing:s})=>{const t=De(),{user:a}=z(),l=T();n.useEffect(()=>{s!=null&&s.gid&&(a!=null&&a.guid)&&(t.setListing(s),me(a.guid,s.gid).then(d=>{(d==null?void 0:d.length)!==0?(t.reset(d),t.setRatingData(d)):t.validateData(d,a)}))},[s,a]);const i=d=>{d?(l.cancel(),window.location.href="/signin"):l.cancel()},r=()=>{((a==null?void 0:a.guid)===null||(a==null?void 0:a.guid)===void 0)&&l.confirm("Login to continue",i)};return e.jsx("div",{className:"mx-auto w-full sm:w-[60%] lg:w-full mt-3",children:e.jsx("button",{onClick:()=>r(),className:`bg-blue-500 text-white flex flex-col
                items-center py-2 w-full `,children:"Write Review"})})},Ee=({ratingsData:s,rating:t=3.5,maxStars:a=5})=>{const l=[];for(let i=1;i<=a;i++)i<=t?l.push(e.jsx("span",{className:"text-yellow-500 text-md",children:e.jsx(W,{})},i)):l.push(e.jsx("span",{className:"text-yellow-500 text-md",children:e.jsx(I,{})},i));return e.jsxs("div",{className:" flex w-full place-items-center gap-2 mt-6",children:[e.jsx("div",{className:"flex  gap-x-[3px] -mt-[2px]",children:l}),e.jsx("div",{className:"text-gray-400",children:e.jsx(C,{className:"text-[15px] text-yellow-400"})}),e.jsxs("div",{className:" text-sm",children:["Rating: ",t]}),e.jsx("div",{className:"text-gray-400",children:e.jsx(C,{className:"text-[15px] text-yellow-400"})}),e.jsxs("div",{className:"text-sm",children:["Reviews: ",Number(s.rating_count)]})]})},Ge=({listing:s})=>{const[t,a]=n.useState(void 0);return n.useEffect(()=>{he(s.gid).then(l=>{a(l)})},[s.business_guid]),e.jsxs("div",{className:" mt-12",children:[e.jsx("div",{className:" font-bold text-xl",children:"Features"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-3",children:t==null?void 0:t.map((l,i)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"font-bold",children:l.name}),e.jsx("div",{className:"text-sm mt-[-2px] text-gray-500 leading-[1.2em] tracking-normal",children:l.user_description||l.description})]},i))})]})},Me=({listing:s})=>e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-lg font-bold",children:"Intro"}),e.jsx("div",{className:" text-[14px] flex flex-col gap-y-4 whitespace-pre-wrap",children:s.short_description})]}),A=({rating:s=3.5,maxStars:t=5})=>{const a=[];for(let l=1;l<=t;l++)l<=s?a.push(e.jsx("span",{className:"text-yellow-500 text-lg",children:e.jsx(W,{})},l)):a.push(e.jsx("span",{className:"text-yellow-500 text-lg",children:e.jsx(I,{})},l));return e.jsxs("div",{className:" flex w-full place-items-center gap-2 mt-0",children:[e.jsx("div",{className:"flex  gap-x-[3px] -mt-[2px]",children:a}),e.jsx("div",{className:"text-gray-400",children:e.jsx(C,{className:"text-[15px] text-yellow-400"})}),e.jsxs("div",{className:" text-sm",children:["Rating: ",Number(s).toFixed(0)]})]})},Fe=({listing:s})=>{const[t,a]=n.useState([]),[l,i]=n.useState({});return n.useEffect(()=>{const r=async m=>{m&&await ue(m).then(u=>{a(u)})},d=async m=>{m&&await pe(m).then(u=>{i(u)})};s.gid&&(r(s.gid),d(s.gid))},[s]),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-xl font-bold",children:"Reviews"}),e.jsxs("div",{className:"-mt-1 text-[14px] flex flex-col -gap-y-1 font-light",children:[e.jsx("div",{className:"font-bold",children:"Overall Rating:"}),l&&e.jsx(A,{rating:l==null?void 0:l.rating_average})]}),e.jsx("hr",{className:"mt-3"}),e.jsx("div",{className:"flex flex-col gap-y-4 divide-y-[1px]",children:t!==null&&(t==null?void 0:t.map((r,d)=>e.jsxs("div",{className:"pt-7 pb-4",children:[e.jsxs("div",{className:"flex place-items-start gap-2",children:[e.jsx("div",{className:`w-[30px] h-[30px] rounded-full
                                        bg-black overflow-hidden`,children:e.jsx("img",{src:r.image_url,alt:""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm font-bold",children:r.fullname}),e.jsx("div",{className:"text-[12px]",children:`${r==null?void 0:r.city_name}, ${r==null?void 0:r.state_name}`}),e.jsx("div",{className:"text-[12px]",children:`${r==null?void 0:r.country_name}`})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{children:e.jsx(A,{rating:r.rating})}),e.jsxs("div",{className:"text-[12px] flex gap-1 place-items-center",children:[e.jsx("b",{children:"Created at:"}),e.jsx("span",{className:"text-[12px]",children:M(r.created_at)})]}),e.jsxs("div",{className:"text-[12px] flex gap-1 place-items-center",children:[e.jsx("b",{children:"Last Edited:"}),e.jsx("span",{className:"text-[12px]",children:M(r.updated_at)})]}),e.jsx("div",{className:"text-[14px] mt-2",children:r.comment})]})]},d)))})]})},Pe=({listing:s,images:t,ratingsData:a})=>e.jsx("div",{className:"px-[20px]",children:e.jsxs("div",{className:"max-w-[1100px] w-full mx-auto bg-white",children:[a&&e.jsx(Ee,{ratingsData:a,rating:Number(a.rating_average)}),s&&e.jsx(Se,{listing:s}),e.jsxs("div",{className:"grid grid-cols-12 mt-4 gap-4 relative",children:[e.jsxs("div",{className:" col-span-12 lg:col-span-8",children:[t&&s&&e.jsx(ke,{images:t,listing:s}),e.jsxs("div",{className:"lg:hidden mt-5 mb-5",children:[e.jsx(F,{}),s&&e.jsx(P,{listing:s})]}),e.jsx(Me,{listing:s}),e.jsx(Ge,{listing:s}),e.jsx(Ce,{listing:s}),s&&e.jsx(Fe,{listing:s})]}),e.jsx("div",{className:"col-span-12 lg:col-span-4 hidden lg:block",children:e.jsxs("div",{className:" sticky top-[100px]",children:[e.jsx(F,{}),e.jsx(P,{})]})})]})]})}),ls=()=>{const s=ce(),t=s.listing;s.related;const a=s.gallery,l=s.ratingsData;return e.jsx(Be,{children:e.jsxs(_e,{children:[e.jsx(re,{}),e.jsx(de,{}),e.jsx(Pe,{listing:t,images:a,ratingsData:l}),e.jsx("div",{className:"h-32"}),e.jsx(ye,{category:t==null?void 0:t.category,limit:6,title:`Related: ${t==null?void 0:t.category}`,subtitle:"Related based on the same category."}),e.jsx(ne,{})]})})};export{ls as default};
