import{r as n,j as e,b as R}from"./components-B3s0IpTW.js";import{R as E}from"./ResponsiveNav-CSwpN3E1.js";import{z as i,u as $,s as k}from"./index-DAH1x-Px.js";import{u as C}from"./AuthContext-8FHLzqeM.js";import{h as F}from"./Lib-DgMjv0aD.js";import{u as A}from"./NotificationContext-7wGW9xfz.js";import"./MobileNav-BsYC7GnI.js";import"./iconBase-Bk1nv4PK.js";import"./index-CDpADjvc.js";const j=new RegExp(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!()Â£@$%^&*-]).{8,}$/),D=i.object({password:i.string().min(1,{message:"Please enter new password."}).min(8,{message:"Password must be up to 8 characters."}).regex(j,{message:"Please enter a valid password"}),password2:i.string().min(1,{message:"Please enter new password."}).min(8,{message:"Password must be at least 8 characters."}).regex(j,{message:"Please enter a valid password"})}).superRefine((t,r)=>{t.password!==t.password2&&r.addIssue({code:i.ZodIssueCode.custom,path:["password2"],message:"Your new password don't match"})}),T=({userGuid:t})=>{var h,f;const[r,y]=n.useState(null),{signin:U}=C(),[d,l]=n.useState(!1),[v,N]=n.useState(""),c=A();n.useEffect(()=>{t&&N(t)},[t]);const x=o=>{let m=o.target.value,p=o.target.name;y(u=>({...u,[p]:m}))},S=async o=>{l(!0),c.notify("Resetting password..."),await new Promise(a=>setTimeout(a,1e3)),o.password;const m="https://gursse.com",p=`/api/users/reset_password/${v}`,u=m+p;try{const a=await fetch(u,{method:"PUT",headers:F,body:JSON.stringify(o)});let b=a.json();a.ok?b.then(w=>{c.notify(`${w.message}. Redirecting...`),setTimeout(()=>{window.location.href="/signin"},3e3)}):b.then(w=>{c.alertCancel("Failed",`${w.message}`)})}catch{return}finally{l(!1)}await new Promise(a=>setTimeout(a,1e3)),l(!1)},{register:g,handleSubmit:P,getValues:V,watch:z,setError:B,formState:{errors:s,isSubmitting:I}}=$({defaultValues:{},resolver:k(D)});return e.jsx("div",{className:"",children:e.jsx("div",{className:"h-screen w-screen bg-white  flex flex-col place-content-center place-items-center pt-16 ",children:e.jsxs("div",{className:" max-w-[300px]",children:[e.jsx("div",{className:" text-[26px] font-[500]",children:e.jsx("div",{className:"pb-1 border-b",children:"Reset Password"})}),e.jsx("div",{className:" mt-4 mb-2 text-[15px] leading-[1.2em]",children:"Use the form below to set a new password for your account!"}),e.jsxs("form",{onSubmit:P(S),children:[e.jsxs("div",{className:" mt-4",children:[e.jsx("input",{...g("password",{onChange:x}),className:" w-full outline-none border-[2px] border-gray-100 focus:border-gray-300 focus:border-[2px]  bg-gray-100  rounded-[8px] h-[50px] px-4",type:"password",placeholder:"Enter new password"}),(s==null?void 0:s.password)&&e.jsx("div",{className:"ml-1 text-red-600 text-[13px]",children:(h=s==null?void 0:s.password)==null?void 0:h.message})]}),e.jsxs("div",{className:" mt-3",children:[e.jsx("input",{...g("password2",{onChange:x}),className:" w-full outline-none border-[2px] border-gray-100 focus:border-gray-300 focus:border-[2px] bg-gray-100   rounded-[8px] h-[50px] px-4",type:"password",placeholder:"Retype New password"}),(s==null?void 0:s.password2)&&e.jsx("div",{className:"ml-1 text-red-600 text-[13px]",children:(f=s==null?void 0:s.password2)==null?void 0:f.message})]}),e.jsx("button",{className:`${d?" bg-gray-500/70":"cursor-pointer bg-black"} mt-3  w-full text-white rounded-[8px] h-[50px] px-4`,type:"submit",disabled:d,children:d?"Submitting...":"Set Password"})]}),e.jsx("div",{className:" mt-3 text-[11px]",children:"By proceeding, you consent to get calls, WhatsApp or SMS/RCS messages, including by automated means, from Dersck and its affiliates to the email provided."})]})})})},Y=()=>{const r=R().userGuid;return e.jsxs("div",{children:[e.jsx(E,{}),r&&e.jsx(T,{userGuid:r})]})};export{Y as default};
